from datetime import datetime, timezone
from bot.utils import constants
from bot.utils.constants import gift_price_by_id
from databases import database

def formarter(var:int):
    return '{:,}'.format(var).replace(",", " ")

def hello():
    return '''
๐๐ ะะพะฑัะพ ะฟะพะถะฐะปะพะฒะฐัั ะฒ Giftly ๐๐
๐ฐ ะะดะตัั ัั ะบัััะธัั ััะปะตัะบั ะธ ะฟะพะปััะฐะตัั ะฟะพะดะฐัะบะธ.
๐ฎ ะะพัััะฟะฝะพ ะฝะตัะบะพะปัะบะพ ะธะณัะพะฒัั ัะตะถะธะผะพะฒ โ ะบะฐะถะดัะน ัะพ ัะฒะพะธะผะธ ัััะฟัะธะทะฐะผะธ.

๐ ะะทะฝะฐะบะพะผััั ั ะฟัะฐะฒะธะปะฐะผะธ ะธ ะฝะฐะถะธะผะฐะน ยซะฏ ัะพะณะปะฐัะตะฝยป โ ะฟะพะดะฐัะบะธ ัะถะต ะถะดัั!
๐ ะะฐั ะบะฐะฝะฐะป: @giftly_ton
    '''
async def menu(user_id):
    info = await database.select_user(user_id)
    dt = datetime.fromtimestamp(info.time_register, tz=timezone.utc)
    formatted_date = dt.strftime('%d %B %Y')
    return f'''
<blockquote><b>๐ฐ ะะฐะปะฐะฝั:</b> {formarter(info.balance_star)}โญ 

<b>๐ ะัะธะณัะฐะฝะพ ะฒัะตะณะพ</b>: {formarter(info.play_win)}โญ
<b>๐ ะะณั ััะณัะฐะฝะพ</b>: {info.count_win}
<b>โฐ ะะฐัะฐ ัะตะณะธัััะฐัะธะธ</b>:\n{formatted_date}

<b>๐ฅ ะะตัะตัะฐะปั</b>: {info.referals}
<b>โญ ะะพัะพะด ะพั ัะตัะตัะฐะปะพะฒ</b>: {info.referal_amount}
</blockquote>
'''

def boxes():
    return '''
โผ๏ธ ะะตัะตะด ะฝะฐัะฐะปะพะผ ะธะณัั
ะะะฏะะะขะะะฌะะ ะฝะฐะฟะธัะธ
@helper_giftly, ััะพะฑั ะฑะพั
ะผะพะณ ะพัะฟัะฐะฒะปััั ะฒัะธะณัััะธโผ๏ธ
    '''
def open_box(name):
    if name.lower() == 'box_default':
        return f'''
๐ Default Box ๐

ะฆะตะฝะฐ ะพัะบัััะธั: {constants.price_box[name.lower().split("_")[1]]}โญ

โ ะะพะถะตั ะฒัะฟะฐััั:

๐ 15โญ    ๐งธ 15โญ
๐ 25โญ    ๐น 25โญ
๐ 50โญ   ๐ 50โญ
๐ 50โญ   ๐พ 50โญ
๐ 100โญ  ๐ 100โญ
๐ 100โญ
'''
    if name.lower() == 'box_lolpop':
        return f'''
๐ญ LolPop Box ๐ญ

ะฆะตะฝะฐ ะพัะบัััะธั: {constants.price_box[name.lower().split("_")[1]]}โญ

โ ะะพะถะตั ะฒัะฟะฐััั:

๐ะEัะฝะธะบะฐะปัะฝัะต ะฟะพะดะฐัะบะธ (40%)
๐Lol pop (15%)
๐Desk Calendar (15%) 
๐Candy Cane (15%)    
        '''

    if name.lower() == 'box_sword':
        return f'''
โ๏ธ Sword Box โ๏ธ

ะฆะตะฝะฐ ะพัะบัััะธั: {constants.price_box[name.lower().split("_")[1]]}โญ

โ ะะพะถะตั ะฒัะฟะฐััั:

๐ ะะตัะฝะธะบะฐะปัะฝัะต ะฟะพะดะฐัะบะธ (50%)
๐ Lol Pop (10%)
๐ Desk Calendar (10%)
๐ Sword (4%)
๐ Spy Agaric (3%)
๐ Witch Hat (3%)  
                '''
    else:
        return f'''
๐ LovePotion Box ๐

ะฆะตะฝะฐ ะพัะบัััะธั: {constants.price_box[name.lower().split("_")[1]]} โญ

โ ะะพะถะตั ะฒัะฟะฐััั:

๐ ะะตัะฝะธะบะฐะปัะฝัะต ะฟะพะดะฐัะบะธ (30%)
๐ Lol Pop (20%)
๐ Desk Calendar (20%)
๐ Sword (7%)
๐ Jelly Bunny (7%)
๐ Love Potion (3%)
๐ Record Ring (3%)
'''
def cong_win_box(result, gift):
    if result == 'game_lose':
        text = '๐ ะะฐ ััะพั ัะฐะท ะฒ ะฑะพะบัะต ะฝะธัะตะณะพ ะฝะต ะพะบะฐะทะฐะปะพัั. ะะพ ะฝะต ัะฐััััะฐะธะฒะฐะนัั โ ัะดะฐัะฐ ัะถะต ััะดะพะผ! ะะพะฟัะพะฑัะน ะพัะบัััั ัะปะตะดัััะธะน! ๐'
    elif result == 'game_win_def':
        text = f'''
<b>๐๐ ะะพะทะดัะฐะฒะปัะตะผ!๐๐</b>

ะ ะฑะพะบัะต ะฑัะป {gift[0]} ({constants.gift_price_by_id[gift[0]]} โญ)

ะงัะพ ะดะฐะปััะต?
๐ ะัะฒะตััะธ ะฟะพะดะฐัะพะบ ะฒ ะฟัะพัะธะปั
๐ ะะฑะผะตะฝััั ะฝะฐ ะทะฒะตะทะดั โ ะธ ะฟะพะปััะธัั +20% ะฑะพะฝััะพะผ! โจ  '''
    elif result == 'game_win_prem':
        text = f'''
<b>๐ ะะพะทะดัะฐะฒะปัะตะผ! ะขะตะฑะต ะฒัะฟะฐะป Telegram Premium! ๐๐</b>

๐ ะขะตะฑะต ะฒัะฟะฐะป Telegram Premium ะฝะฐ {gift} ะผะตัััะตะฒ โ ะฝะธะบะฐะบะพะน ัะตะบะปะฐะผั, ััะฟะตััะบะพัะพััั ะธ ัะบัะบะปัะทะธะฒะฝัะต ัะธัะบะธ!
        '''
    elif result == 'game_win_list':
        text =     f'''
<b>๐ ะขะตะฑะต ะฒัะฟะฐะป ะฝะตัะฝะธะบะฐะปัะฝัะน ะฟะพะดะฐัะพะบ! ๐</b>

ะ ััะตะนะบะฐั ัะฟัััะฐะฝั ะฟะพะดะฐัะบะธ ัะฐะทะฝะพะน ััะพะธะผะพััะธ โ ะพั <b>15</b>โญ ะดะพ <b>100</b>โญ ๐
ะัะฑะตัะธ ะพะดะฝั ััะตะนะบั, ััะพะฑั ะทะฐะฑัะฐัั ะฟะพะดะฐัะพะบ ะธะปะธ ะพะฑะผะตะฝััั ะตะณะพ ะฝะฐ ะทะฒัะทะดั โจ'''
    elif result == 'game_win':
        text =  f'''
๐๐ ะะพะทะดัะฐะฒะปัะตะผ! ๐๐

ะ ะฑะพะบัะต ะฑัะป NFT ะฟะพะดะฐัะพะบ <a href="t.me/nft/{gift.name}">{gift.name}</a> โ ะพะฝ ัะถะต ะพัะฟัะฐะฒะปะตะฝ ะฝะฐ ะฒะฐั ะฐะบะบะฐัะฝั. ะะฐัะปะฐะถะดะฐะนัะตัั!'''

    return text
def bomb_game(result, info_cell = None, NFT = None):
    if result == 'lose':
        return  '''
๐ ะะต ะฟะพะฒะตะทะปะพ! ะะธะฝะฐ ะฟััะผะพ ะฟะพะด ะฝะพะณะฐะผะธ ๐
        
๐ ะะพะดะฐัะบะธ ะฝะต ะดะพััะฐัััั ัะตะผ, ะบัะพ ัะฟะตัะธั. ะะพะฟัะพะฑัะตัั ัะฝะพะฒะฐ? ๐
'''
    elif result == 'default':
        return f'ะะพะด ััะตะนะบะพะน ะฑัะป ะฟะพะดะฐัะพะบ {info_cell["emodji"]} ({gift_price_by_id[info_cell["emodji"]]} โญ) ะฟัะพะดะพะปะถะธะผ?'
    elif result == 'nft':
        return f'''
๐NFT ะฟะพะดะฐัะพะบ <a href="t.me/nft/{NFT.name}">{NFT.name}</a> ัะถะต ะพัะฟัะฐะฒะปะตะฝ ะฝะฐ ะฒะฐั ะฐะบะบะฐัะฝั. ะะฐัะปะฐะถะดะฐะนัะตัั!๐
'''
def cong_win(item):
    return f'''
๐ ะะพะทะดัะฐะฒะปัะตะผ! ๐

ะะพะด ััะตะนะบะพะน ะฑัะปะพ: {item.split('_')[1]} ({constants.gift_price_by_id[item.split("_")[1]]} โญ)

ะงัะพ ะดะฐะปััะต?
๐ ะัะฒะตััะธ ะฟะพะดะฐัะพะบ ะฒ ะฟัะพัะธะปั
๐ ะะฑะผะตะฝััั ะฝะฐ ะทะฒะตะทะดั โ ะธ ะฟะพะปััะธัั +20% ะฑะพะฝััะพะผ! โจ  
    '''
def cong_win(item):
    return f'''
๐ ะะพะทะดัะฐะฒะปัะตะผ! ๐

ะะพะด ััะตะนะบะพะน ะฑัะปะพ: {item.split('_')[1]} ({constants.gift_price_by_id[item.split("_")[1]]} โญ)

ะงัะพ ะดะฐะปััะต?
๐ ะัะฒะตััะธ ะฟะพะดะฐัะพะบ ะฒ ะฟัะพัะธะปั
๐ ะะฑะผะตะฝััั ะฝะฐ ะทะฒะตะทะดั โ ะธ ะฟะพะปััะธัั +20% ะฑะพะฝััะพะผ! โจ  
    '''
def support_text():
    return  '''
๐ฉ ะััะฐะปะธัั ะฒะพะฟัะพัั?
ะะธัะธ โ ะฟะพะดะดะตัะถะบะฐ ะฒัะตะณะดะฐ ะฝะฐ ัะฒัะทะธ: ะขะตัะฟะพะดะดะตัะถะบะฐ

๐ ะก ะฟัะฐะฒะธะปะฐะผะธ ะฟัะพะตะบัะฐ ะผะพะถะฝะพ ะพะทะฝะฐะบะพะผะธัััั ะทะดะตัั: ะัะฐะฒะธะปะฐ

๐ ะั ััะดะพะผ, ะตัะปะธ ััะพ-ัะพ ะฟะพะนะดัั ะฝะต ัะฐะบ ๐
'''

def top_choice():
    return '''
๐ ะขะพะฟั Giftly ๐

ะัะฑะตัะธ, ััะพ ัะพัะตัั ะฟะพัะผะพััะตัั:

๐ ะะพ ะฒัะธะณัััะฐะผ
๐ ะะพ ัะตัะตัะฐะปะฐะผ

๐ ะะฐะถะผะธ ะฝะฐ ะบะฝะพะฟะบั ะฝะธะถะต, ััะพะฑั ะฒัะฑัะฐัั ะบะฐัะตะณะพัะธั ัะตะนัะธะฝะณะฐ!  
'''

def referal_program(user_id, user_info):
    ref_count = user_info.referals
    ref_earned = user_info.referal_amount
    return \
f'''
<b>๐ ะะฐััะบะฐะถะธ ะพ Giftly โ ะทะฐะฑะตัะธ ัะฒะพะน ะฟัะพัะตะฝั! ๐</b>

ะะพะดะตะปะธัั ะฑะพัะพะผ ั ะดััะทััะผะธ ะธ <b>ะทะฐะฑะธัะฐะน 15%</b> ัะพ ะฒัะตั ะธั ะดะพะฝะฐัะพะฒ ๐ธ
ะะฝะธ ะบััััั ััะปะตัะบะธ โ ะฐ ัะตะฑะต ะบะฐะฟะฐัั โญ ะฐะฒัะพะผะฐัะธัะตัะบะธ!

<b>๐ฅ ะขะฒะพะธั ัะตัะตัะฐะปะพะฒ: {ref_count}</b>
<b>๐ฐ ะะฐัะฐะฑะพัะฐะฝะพ ั ะฝะธั: {ref_earned} โญ</b>

๐ ะขะฒะพั ัััะปะบะฐ:
https://t.me/giftlyTON_bot?start=ref{user_id}
'''

def flour(num):
    text = [
        'ะญัะพ ะฝะฐัะฐะปัะฝัะน ััะฐะถ: 1 ะฑะพะผะฑะฐ',
        'ะญัะพ ะฒัะพัะพะน ััะฐะถ: 2 ะฑะพะผะฑั',
        'ะญัะพ ััะตัะธะน ััะฐะถ: 3 ะฑะพะผะฑั',
        'ะญัะพ ัะตัะฒะตัััะน ััะฐะถ: 3 ะฑะพะผะฑั',
        'ะญัะพ ะฟะพัะปะตะดะฝะธะน ััะฐะถ, ะฟัะพะนะดะธ ะตะณะพ ะธ ะฟะพะปััะธ NFT'
    ]
    return text[int(num)]

def choice_casino():
    return '''
<b>๐ฎ ะัะฑะตัะธ ัะตะถะธะผ ะธะณัั</b>

<b>๐ ะะฐัะบะตัะฑะพะป</b> โ ะฑัะพัะบะธ ะฒ ะบะพะปััะพ
<b>โฝ ะคััะฑะพะป</b> โ ัะดะฐัั ะฟะพ ะฒะพัะพัะฐะผ
<b>๐ฏ ะะฐััั</b> โ ะผะตัะบะธะต ะฟะพะฟะฐะดะฐะฝะธั
<b>๐ณ ะะพัะปะธะฝะณ</b> โ ัะฑะตะน ะผะฐะบัะธะผัะผ ะบะตะณะปะตะน     

๐ <b>ะะณัะฐะน ะฟัะพัะธะฒ ะฑะพัะฐ</b> โ ั ะบะฐะถะดะพะณะพ ะฟะพ 3 ะฟะพะฟััะบะธ.
๐ ะัะปะธ ัั ะฝะฐะฑะตัััั ะฑะพะปััะต ะพัะบะพะฒ, ัะตะผ ะฑะพั โ <b>๐ฐ ัะดะฒะพะธัั ัะฒะพั ััะฐะฒะบั!</b>
    '''

def lbomb_info():
    return '''
1๏ธโฃ ะัะฑะธัะฐะนัะต ะบะปะตัะบั ะฝะฐ ะฟะพะปะต (5x5)
2๏ธโฃ ะัะปะธ ัะฐะผ ๐ โ ะทะฐะฑะตัะธัะต ะฟัะธะท ะธะปะธ ะฟัะพะดะพะปะถะฐะนัะต ะธะณัั
3๏ธโฃ ะัะปะธ ะฝะฐะนะดััะต ๐ผ๏ธ NFT-ะฟะพะดะฐัะพะบ โ ะฟะพะปััะธัะต ัะตะดะบะธะน NFT
4๏ธโฃ ะัะปะธ ะฟะพะฟะฐะดััะต ะฝะฐ ๐ฅ ะฑะพะผะฑั โ ัะตััะตัะต ััะฐะฒะบั    
    '''
def task_info(x, user):
    id_task = x.id
    desc_task = x.description
    name_task = x.name
    bonus = x.bonus
    uniq_text = {
        1: '',
        2: f'({user.referals}/1)',
        3: f'({user.referals}/10)'
    }
    return f'''
<b>โ{id_task} | {name_task} ({bonus}โญ)</b>
{'โ' if x.id in user.tasks else f'โ {desc_task} {uniq_text.get(id_task, '')}'}
    '''

def tower_info():
    return '''
๐ ะ ะบะฐะถะดะพะผ ััะดั ัะฟัััะฐะฝั ะฟะพะดะฐัะบะธ
๐ ะัะฑะธัะฐะน ะฟะพ 1 ััะตะนะบะต ะฒ ะบะฐะถะดะพะผ ััะดั
๐ ะะต ะฟะพะฟะฐะป ะฝะฐ ะฑะพะผะฑั โ ะธะดััั ะดะฐะปััะต
๐ ะัะพะนะดะธ ะฒัะต 5 ััะดะพะฒ โ ะธ ะฟะพะปััะธ NFT
๐ ะะพะฟะฐะป ะฝะฐ ะฑะพะผะฑั โ ะธะณัะฐ ะทะฐะบะฐะฝัะธะฒะฐะตััั
    '''

def casino_plays(mode):
    data = {
        'basketball': (
            "๐ <b>ะะฐัะบะตัะฑะพะป</b>\n"
            "ะฃ ัะตะฑั 3 ะฑัะพัะบะฐ ะฒ ะบะพะปััะพ.\n"
            "๐ ะัะบะธ:\n"
            "โซ๏ธ ะะธะผะพ โ 0\n"
            "โซ๏ธ ะะพะปััะพ โ 2\n"
            "ะะฐะฑะตัะธ ะฑะพะปััะต ะพัะบะพะฒ, ัะตะผ ะฑะพั, ััะพะฑั <b>ัะดะฒะพะธัั ััะฐะฒะบั</b>!"
        ),
        'football': (
            "โฝ <b>ะคััะฑะพะป</b>\n"
            "3 ัะดะฐัะฐ ะฟะพ ะฒะพัะพัะฐะผ โ ะฟะพะบะฐะถะธ ัะพัะฝะพััั ะธ ัะธะปั ัะดะฐัะฐ!\n"
            "๐ ะัะบะธ:\n"
            "โซ๏ธ ะะธะผะพ โ 0\n"
            "โซ๏ธ ะะพะป โ 1\n"
            "ะะฑะณะพะฝะธ ะฑะพัะฐ ะฟะพ ััะผะผะต โ ะธ <b>ะทะฐะฑะตัะธ ั2</b> ะพั ััะฐะฒะบะธ!"
        ),
        'darts': (
            "๐ฏ <b>ะะฐััั</b>\n"
            "ะะตัะฝะธ 3 ัััะตะปั ะธ ะฟะพััะฐัะฐะนัั ะฟะพะฟะฐััั ะฒ ัะตะฝัั.\n"
            "๐ ะัะบะธ:\n"
            "โซ๏ธ ะะฝะตัะฝะตะต ะบะพะปััะพ โ 1\n"
            "โซ๏ธ ะกัะตะดะฝะตะต ะบะพะปััะพ โ ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั ัะฐัััะพัะฝะธั ะดะพ ัะตะฝััะฐ (2-4)\n"
            "โซ๏ธ ะฆะตะฝัั โ 5\n"
            "ะกะพะฑะตัะธ ะฑะพะปััะต ะพัะบะพะฒ, ัะตะผ ะฑะพั โ <b>ะธ ะฟะพะปััะธ ัะดะฒะพะตะฝะฝัั ะฝะฐะณัะฐะดั</b>!"
        ),
        'bouling': (
            "๐ณ <b>ะะพัะปะธะฝะณ</b>\n"
            "3 ะฑัะพัะบะฐ ัะฐัะพะผ โ ัะฑะตะน ะบะฐะบ ะผะพะถะฝะพ ะฑะพะปััะต ะบะตะณะปะตะน!\n"
            "๐ ะัะบะธ = ัะฑะธััะต ะบะตะณะปะธ (ะผะฐะบัะธะผัะผ โ 6 ะทะฐ ะฑัะพัะพะบ)\n"
            "ะกัะผะผะฐัะฝะพ ะผะพะถะฝะพ ะฝะฐะฑัะฐัั ะดะพ 18 ะพัะบะพะฒ.\n"
            "<b>ะกะฑะตะน ะฑะพะปััะต, ัะตะผ ะฑะพั โ ะธ ะทะฐะฑะตัะธ ั2!</b>"
        )
    }
    return data.get(mode, 'ะญะผะผะผ')
